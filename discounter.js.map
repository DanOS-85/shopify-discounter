{"version":3,"file":"discounter.js","sourceRoot":"","sources":["src/discounter.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\nimport {LitElement, html, css} from 'lit';\nimport {customElement, state} from 'lit/decorators.js';\nimport { CLOSE_ICON, DISCOUNT_ICON, GIFT_ICON, INFO_ICON, SPINNER_ICON } from './constants';\nimport { DataController, GiftCard, CheckoutData, Discount } from './data-controller';\n\n/**\n * An example element.\n *\n * @fires count-changed - Indicates when the count changes\n * @slot - This element has a slot\n * @csspart button - The button\n */\n@customElement('discounter-form')\nexport class DiscounterForm extends LitElement {\n  static override styles = css`\n    .discounter-component__form--wrapper {\n      padding: 6px\n    }\n    .discounter-component__form {\n      display: flex;\n      flex-wrap: wrap;\n      gap: 12px;\n    }\n    .discounter-component__form input {\n      border-radius: 5px;\n      padding: 13px 11px;\n    }\n    .discounter-component__form input.error {\n      border: 1px solid #ff6d6d;\n    }\n    .discounter-component__form button {\n      border-radius: 5px;\n      background: black;\n      color: white;\n      font-weight: 600;\n      padding: 13px 24px;\n      position: relative;\n    }\n    .discounter-component__form button[disabled] {\n      cursor: not-allowed;\n      opacity: 0.4;\n    }\n    .discounter-component__form button svg {\n      visibility: hidden;\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      margin-top: -10px;\n      margin-left: -10px;\n      transition: opacity 0.3s ease-in-out;\n      opacity: 0;\n    }\n    .discounter-component__form button.loading span {\n      visibility: hidden;\n    }\n    .discounter-component__form button.loading svg {\n      animation: rotate 0.5s linear infinite;\n      visibility: visible;\n      opacity: 1;\n    }\n    .discounter-component__message {\n      color: #ff6d6d;\n      font-size: 14px;\n      margin: 8px 0 4px;\n    }\n    .discounter-component__codes {\n      display: flex;\n      flex-wrap: wrap;\n      gap: 10px;\n      margin-top: 12px;\n    }\n    .discounter-component__tooltip {\n      background: aliceblue;\n      padding: 8px;\n      border-radius: 5px;\n      font-weight: 600;\n      left: 50%;\n      top: 50%;\n      white-space: nowrap;\n    }\n    .discounter-component__code {\n      background-color: rgba(113, 113, 113, 0.11);\n      border-radius: 5px;\n      color: #717171;\n      display: inline-flex;\n      gap: 8px;\n      padding: 10px;\n    }\n    .discounter-component__code span {\n      align-items: center;\n      display: flex;\n      font-size: 13px;\n      font-weight: 600;\n      gap: 8px;\n    }\n    .discounter-component .icon {\n      fill: currentColor;\n      height: 18px;\n      width: 18px;\n    }\n    .discounter-component__code button {\n      background: transparent;\n      border: 0;\n      cursor: pointer;\n      padding: 0;\n    }\n    .discounter-component__code button .spinner_icon {\n      animation: rotate 0.5s linear infinite;\n    }\n    .discounter-component__code button .close_icon,\n    .discounter-component__code button.loading .spinner_icon {\n      display: block;\n    }\n    .discounter-component__code button .spinner_icon,\n    .discounter-component__code button.loading .close_icon {\n      display: none;\n    }\n    @keyframes rotate {\n      0% {\n        transform: rotate(0);\n      }\n      100% {\n        transform: rotate(360deg);\n      }\n    }\n  `;\n\n  @state()\n  private hide = false;\n\n  @state()\n  private error = false;\n\n  @state()\n  private loading = false;\n\n  @state()\n  private code = '';\n\n  private dataFetcher = new DataController(this);\n\n  override updated() {\n    const detail = {data: this.dataFetcher._data};\n    const event = new CustomEvent('discounter-update', {detail, bubbles: true, composed: true, cancelable: true});\n    this.dispatchEvent(event);\n  }\n\n  handleInput(event: InputEvent) {\n    this.error = false;\n    this.code = (event.target as HTMLInputElement)?.value;\n  }\n\n  showTooltip(event: MouseEvent) {\n    const tooltip = (event.currentTarget as HTMLDivElement).firstElementChild as HTMLDivElement;\n    tooltip.style.display = \"block\";\n  }\n  \n  hideTooltip(event: MouseEvent) {\n    const tooltip = (event.currentTarget as HTMLDivElement).firstElementChild as HTMLDivElement;\n    tooltip.style.display = \"none\";\n  }\n\n  async clearDiscount(event: Event, code: string) {\n    await this.dataFetcher.clearDiscount(event, code)\n    this.code = '';\n    this.error = false;\n  }\n\n  async clearGiftCard(event: Event, giftCard: GiftCard) {\n    await this.dataFetcher.clearGiftCard(event, giftCard)\n    this.code = '';\n    this.error = false;\n  }\n\n  private async applyCode() {\n    if (!this.code.length) {\n      return;\n    }\n\n    this.loading = true;\n\n    try {\n      await this.dataFetcher.applyCode(this.code);\n      this.code = '';\n      this.loading = false;\n    } catch (error) {\n      this.code = '';\n      this.loading = false;\n      this.error = true;\n      console.log(error);\n    }\n  }\n\n  private getDiscountsAndGifts() {\n    if (\n      this.dataFetcher._discounts.length ||\n      this.dataFetcher._gift_cards.length\n    ) {\n      return html`<div class=\"discounter-component__codes\">\n        ${this.dataFetcher._discounts.map((discount: Discount) => {\n\n          const markup = discount.application_type === \"automatic\" ?\n          html`<div\n              style=\"position: relative; display: flex;\"\n              @mouseenter=${this.showTooltip}\n              @mouseleave=${this.hideTooltip}\n            >\n              <div class=\"discounter-component__tooltip\" style=\"position: absolute; display: none;\">\n                Automatic discount can't be removed\n              </div>\n              ${INFO_ICON}\n            </div>\n          `:\n          html`<button\n              type=\"button\"\n              @click=${(event: Event) => this.clearDiscount(event, discount.title)}\n            >\n              ${CLOSE_ICON}\n              ${SPINNER_ICON}\n            </button>\n          `;\n\n          return html`\n            <div class=\"discounter-component__code\">\n              <span>\n                ${DISCOUNT_ICON}\n                <span>${discount.title.toUpperCase()}</span>\n              </span>\n              ${markup}\n            </div>\n          `;\n        })}\n\n        ${this.dataFetcher._gift_cards.map((gift_card: GiftCard) => {\n\n          return html`\n            <div class=\"discounter-component__code\">\n              <span>\n                ${GIFT_ICON}\n                <span>•••• ${gift_card.last_characters.toUpperCase()}</span>\n              </span>\n              <button\n                type=\"button\"\n                @click=${(event: Event) => this.clearGiftCard(event, gift_card)}\n              >\n                ${CLOSE_ICON}\n                ${SPINNER_ICON}\n              </button>\n            </div>\n          `;\n        })}\n      </div>`;\n    }\n\n    return '';\n  }\n\n  override render() {\n    if (this.hide) {\n      return '';\n    }\n\n    const classes = this.loading ? 'button loading': 'button';\n    const errorClass = this.error ? 'error' : '';\n\n    return html`\n      <div class=\"discounter-component\">\n        <div class=\"discounter-component__form--wrapper\">\n          <div class=\"discounter-component__form\">\n            <input\n              type=\"text\"\n              class=${errorClass}\n              placeholder=\"Gift card or discount code\"\n              .value=${this.code}\n              @input=${this.handleInput}\n            >\n            <button\n              type=\"submit\"\n              class=${classes}\n              ?disabled=${!this.code.length}\n              @click=${this.applyCode}\n            >\n              <span>Apply</span>\n              ${SPINNER_ICON}\n            </button>\n          </div>\n\n          ${\n            this.error\n            ? html`<p class=\"discounter-component__message\">Enter a valid discount code or gift card</p>`\n            : ''\n          }\n        </div>\n\n        ${this.getDiscountsAndGifts()}\n      </div>\n    `;\n  }\n}\n\n@customElement('discounter-summary')\nexport class DiscounterSummary extends LitElement {\n  static override styles = css`\n    .visually-hidden {\n      border: 0;\n      clip: rect(0, 0, 0, 0);\n      clip: rect(0 0 0 0);\n      width: 2px;\n      height: 2px;\n      margin: -2px;\n      overflow: hidden;\n      padding: 0;\n      position: absolute;\n      white-space: nowrap;\n    }\n    .discounter-summary .icon {\n      fill: currentColor;\n      height: 18px;\n      width: 18px;\n    }\n\n    .name {\n      font-size: 14px;\n      font-weight: 400;\n      text-align: left;\n    }\n\n    .name span:nth-child(2) {\n      margin-left: 8px;\n    }\n\n    .price {\n      font-size: 14px;\n      font-weight: 600;\n      text-align: right;\n    }\n\n    .footer .name {\n      font-size: 16px;\n      font-weight: 400;\n    }\n\n    .footer .currency {\n      font-size: 12px;\n      font-weight: 400;\n    }\n\n    .footer .emphasis {\n      font-size: 24px;\n      font-weight: 600;\n      letter-spacing: -0.04em;\n      line-height: 1em;\n    }\n\n    .footer .name,\n    .footer .price {\n      line-height: 1.3em;\n      padding-top: 3em;\n      white-space: nowrap;\n    }\n\n    .footer .payment-due {\n      position: relative;\n    }\n\n    .footer .payment-due::after {\n      background-color: rgba(162,170,172,0.34);\n      content: '';\n      position: absolute;\n      top: 1.5em;\n      left: 0;\n      width: 100%;\n      height: 1px;\n    }\n  `;\n\n  constructor() {\n    super();\n    window.addEventListener('discounter-update', ((\n      event: CustomEvent\n    ) => {\n      this.data = event.detail.data;\n    }) as EventListener);\n  }\n\n  private _getDiscounts(locale: string, currency: string) {\n    if (this.data.checkout.applied_discounts.length) {\n      return html`\n        ${\n          this.data.checkout.applied_discounts.map(discount => {\n            return html`<tr class=\"reduction-code\">\n            <th class=\"name\" scope=\"row\">\n              <span>Discount</span>\n              <span>\n                ${DISCOUNT_ICON}\n                <span class=\"text\">${discount.title.toUpperCase()}</span>\n              </span>\n            </th>\n    \n            <td class=\"price\">\n              <span class=\"emphasis\" aria-hidden=\"true\">\n                - ${this._formatMoney(\n                    locale,\n                    currency,\n                    discount.amount)\n                  }\n              </span>\n              <span class=\"visually-hidden\">\n                ${this._formatMoney(\n                  locale,\n                  currency,\n                  discount.amount)\n                } off total order price\n              </span>\n            </td>\n          </tr>`;\n          })\n        }\n      `;\n    }\n\n    return ''\n  }\n\n  private _getGiftCards(locale: string, currency: string) {\n    if (this.data.checkout.gift_cards.length) {\n      return html`\n        ${\n          this.data.checkout.gift_cards.map(giftCard => {\n            return html`<tr class=\"reduction-code\">\n                <th class=\"name\" scope=\"row\">\n                  <span>Gift card</span>\n                  <span>\n                    ${GIFT_ICON}\n                    <span class=\"text\">\n                      <span aria-hidden=\"true\">•••• ${giftCard.last_characters.toUpperCase()}</span>\n                      <span class=\"visually-hidden\">\n                        Gift card ending with ${giftCard.last_characters.toUpperCase()}\n                      </span>\n                    </span>\n                  </span>\n                </th>\n\n                <td class=\"price\">\n                  <span class=\"emphasis\">\n                    - ${this._formatMoney(\n                        locale,\n                        currency,\n                        giftCard.presentment_amount_used)\n                      }\n                  </span>\n                </td>\n              </tr>`;\n          })\n        }\n      `;\n    }\n\n    return ''\n  }\n\n  private _formatMoney(locale: string, currency: string, amount: string) {\n    return new Intl.NumberFormat(locale, { style: 'currency', currency }).format(+amount);\n  }\n\n  private dataFetcher = new DataController(this);\n\n  @state()\n  private data: CheckoutData = this.dataFetcher._data;\n\n  override render() {\n    if (!this.data.checkout.total_line_items_price) {\n      return '';\n    }\n\n    return html`\n      <div class=\"discounter-summary\">\n        <table class=\"table\">\n          <caption class=\"visually-hidden\">Cost summary</caption>\n          <thead>\n            <tr>\n              <th scope=\"col\"><span class=\"visually-hidden\">Description</span></th>\n              <th scope=\"col\"><span class=\"visually-hidden\">Price</span></th>\n            </tr>\n          </thead>\n          <tbody class=\"tbody\">\n            <tr class=\"subtotal\">\n              <th class=\"name\" scope=\"row\">Subtotal</th>\n              <td class=\"price\">\n                <span class=\"emphasis\">\n                  ${this._formatMoney(\n                    this.data.checkout.customer_locale,\n                    this.data.checkout.presentment_currency,\n                    this.data.checkout.total_line_items_price\n                  )}\n                </span>\n              </td>\n            </tr>\n\n            ${this._getDiscounts(this.data.checkout.customer_locale, this.data.checkout.presentment_currency)}\n            ${this._getGiftCards(this.data.checkout.customer_locale, this.data.checkout.presentment_currency)}\n          </tbody>\n          <tfoot class=\"footer\">\n            <tr class=\"payment-due\">\n              <th class=\"name\" scope=\"row\">Total</th>\n              <td class=\"price\">\n                <span class=\"currency\">${this.data.checkout.presentment_currency}</span>\n                <span class=\"emphasis\">\n                  ${this._formatMoney(\n                    this.data.checkout.customer_locale,\n                    this.data.checkout.presentment_currency,\n                    this.data.checkout.payment_due\n                  )}\n                </span>\n              </td>\n            </tr>\n          </tfoot>\n        </table>\n      </div>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'discounter-form': DiscounterForm;\n  }\n}\n"]}